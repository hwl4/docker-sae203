<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Chat Docker SAE 2.03</title>
	<style>
		:root {
			--background-light: #f4f4f4;
			--background-dark: #2c2f33;
			--text-light: #333;
			--text-dark: #fff;
			--message-light: #e3e5e8;
			--message-dark: #40444b;
		}

		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: flex-start;
			height: 100vh;
			margin: 0;
			padding-top: 20px;
			background-color: var(--background-dark);
			color: var(--text-dark);
			transition: background-color 0.5s, color 0.5s;
		}

		h1 {
			margin-bottom: 10px;
		}

		#themeToggle {
			margin-bottom: 20px;
			padding: 10px 20px;
			font-size: 14px;
			cursor: pointer;
			border: none;
			border-radius: 8px;
		}

		#chat {
			width: 90%;
			max-width: 600px;
			height: 60vh;
			background: var(--message-dark);
			border-radius: 10px;
			overflow-y: auto;
			padding: 10px;
			box-shadow: 0 0 10px rgba(0,0,0,0.5);
			margin-bottom: 20px;
		}

		.message {
			background: var(--background-dark);
			margin-bottom: 10px;
			padding: 10px;
			border-radius: 8px;
			word-break: break-word;
		}

		#message {
			padding: 10px;
			font-size: 16px;
			width: 300px;
			border-radius: 8px;
			border: none;
		}

		button {
			padding: 10px 20px;
			font-size: 16px;
			margin-left: 10px;
			cursor: pointer;
			border-radius: 8px;
			border: none;
		}
	</style>
</head>
<body>

	<h1>Chat Docker SAE</h1>

	<button id="themeToggle" onclick="toggleTheme()">Changer le Th√®me</button>

	<div id="chat"></div>

	<div>
		<input type="text" id="message" placeholder="Votre message...">
		<button onclick="sendMessage()">Envoyer</button>
	</div>

	<script>
		const ws = new WebSocket('ws://' + window.location.host);

		ws.onmessage = function(event) {
			const chat = document.getElementById('chat');
			const msg = document.createElement('div');
			msg.className = 'message';

			if (event.data instanceof Blob) {
				const reader = new FileReader();
				reader.onload = function () {
					msg.innerText = reader.result;
					chat.appendChild(msg);
					chat.scrollTop = chat.scrollHeight;
				};
				reader.readAsText(event.data);
			} else {
				msg.innerText = event.data;
				chat.appendChild(msg);
				chat.scrollTop = chat.scrollHeight;
			}
		};

		function sendMessage() {
			const input = document.getElementById('message');
			if (input.value.trim() !== '') {
				ws.send(input.value.trim());
				input.value = '';
			}
		}

		function toggleTheme() {
			const root = document.documentElement;
			if (root.style.getPropertyValue('--background-dark') === '#2c2f33') {
				// Passer en clair
				root.style.setProperty('--background-dark', '#ffffff');
				root.style.setProperty('--text-dark', '#000000');
				root.style.setProperty('--message-dark', '#e3e5e8');
			} else {
				// Passer en sombre
				root.style.setProperty('--background-dark', '#2c2f33');
				root.style.setProperty('--text-dark', '#ffffff');
				root.style.setProperty('--message-dark', '#40444b');
			}
		}
	</script>

</body>
</html>
